name: Build And Push Docker Image

on:
  push:
    branches:
      - master
    paths:
      - api/**
      - cmd/**.go
      - deployment/**
      - go.mod
      - go.sum
    tags:
      - "v*.*.*"
  pull_request:

jobs:
  build:
    # NOT support strategy on reusable workflow
    # strategy:
    #   fail-fast: false
    #   matrix:
    #     service: [api]
    uses: mintak21/actions/.github/workflows/build.yml@main
    env:
      service: api
    with:
      image: ${{ github.repository }}/${{ env.service }}
      dockerfile: deployment/dockerfile/${{ env.service }}/Dockerfile
